2023-10-05 03:13:10,403 INFO    MainThread:5618 [wandb_setup.py:_flush():76] Current SDK version is 0.15.12
2023-10-05 03:13:10,403 INFO    MainThread:5618 [wandb_setup.py:_flush():76] Configure stats pid to 5618
2023-10-05 03:13:10,404 INFO    MainThread:5618 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2023-10-05 03:13:10,404 INFO    MainThread:5618 [wandb_setup.py:_flush():76] Loading settings from /content/drive/MyDrive/PaddleOCR/wandb/settings
2023-10-05 03:13:10,404 WARNING MainThread:5618 [wandb_setup.py:_flush():76] Unknown environment variable: WANDB_SERVICE
2023-10-05 03:13:10,404 INFO    MainThread:5618 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2023-10-05 03:13:10,404 INFO    MainThread:5618 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2023-10-05 03:13:10,404 INFO    MainThread:5618 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'tools/train.py', 'program_abspath': '/content/drive/MyDrive/PaddleOCR/tools/train.py', 'program': '/content/drive/MyDrive/PaddleOCR/tools/train.py'}
2023-10-05 03:13:10,405 INFO    MainThread:5618 [wandb_init.py:_log_setup():528] Logging user logs to ./output/ch_PP-OCR_v3_det_05102023_v2/wandb/run-20231005_031310-wr85h5vl/logs/debug.log
2023-10-05 03:13:10,405 INFO    MainThread:5618 [wandb_init.py:_log_setup():529] Logging internal logs to ./output/ch_PP-OCR_v3_det_05102023_v2/wandb/run-20231005_031310-wr85h5vl/logs/debug-internal.log
2023-10-05 03:13:10,405 INFO    MainThread:5618 [wandb_init.py:init():568] calling init triggers
2023-10-05 03:13:10,406 INFO    MainThread:5618 [wandb_init.py:init():575] wandb.init called with sweep_config: {}
config: {}
2023-10-05 03:13:10,406 INFO    MainThread:5618 [wandb_init.py:init():618] starting backend
2023-10-05 03:13:10,406 INFO    MainThread:5618 [wandb_init.py:init():622] setting up manager
2023-10-05 03:13:10,410 INFO    MainThread:5618 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2023-10-05 03:13:10,411 INFO    MainThread:5618 [wandb_init.py:init():628] backend started and connected
2023-10-05 03:13:10,419 INFO    MainThread:5618 [wandb_init.py:init():720] updated telemetry
2023-10-05 03:13:15,396 INFO    MainThread:5618 [wandb_init.py:init():753] communicating run to backend with 90.0 second timeout
2023-10-05 03:13:16,001 INFO    MainThread:5618 [wandb_run.py:_on_init():2220] communicating current version
2023-10-05 03:13:16,128 INFO    MainThread:5618 [wandb_run.py:_on_init():2229] got version response 
2023-10-05 03:13:16,129 INFO    MainThread:5618 [wandb_init.py:init():804] starting run threads in backend
2023-10-05 03:13:16,209 INFO    MainThread:5618 [wandb_run.py:_console_start():2199] atexit reg
2023-10-05 03:13:16,210 INFO    MainThread:5618 [wandb_run.py:_redirect():2054] redirect: wrap_raw
2023-10-05 03:13:16,210 INFO    MainThread:5618 [wandb_run.py:_redirect():2119] Wrapping output streams.
2023-10-05 03:13:16,210 INFO    MainThread:5618 [wandb_run.py:_redirect():2144] Redirects installed.
2023-10-05 03:13:16,211 INFO    MainThread:5618 [wandb_init.py:init():845] run started, returning control to user process
2023-10-05 03:13:16,213 INFO    MainThread:5618 [wandb_run.py:_config_callback():1324] config_cb None None {'Architecture': {'Models': {'Student': {'Backbone': {'disable_se': True, 'model_name': 'large', 'name': 'MobileNetV3', 'scale': 0.5}, 'Head': {'k': 50, 'name': 'DBHead'}, 'Neck': {'name': 'RSEFPN', 'out_channels': 96, 'shortcut': True}, 'Transform': None, 'algorithm': 'DB', 'model_type': 'det', 'pretrained': None}, 'Student2': {'Backbone': {'disable_se': True, 'model_name': 'large', 'name': 'MobileNetV3', 'scale': 0.5}, 'Head': {'k': 50, 'name': 'DBHead'}, 'Neck': {'name': 'RSEFPN', 'out_channels': 96, 'shortcut': True}, 'Transform': None, 'algorithm': 'DB', 'model_type': 'det', 'pretrained': None}, 'Teacher': {'Backbone': {'in_channels': 3, 'layers': 50, 'name': 'ResNet_vd'}, 'Head': {'k': 50, 'kernel_list': [7, 2, 2], 'name': 'DBHead'}, 'Neck': {'name': 'LKPAN', 'out_channels': 256}, 'algorithm': 'DB', 'freeze_params': True, 'model_type': 'det', 'return_all_feats': False}}, 'algorithm': 'Distillation', 'model_type': 'det', 'name': 'DistillationModel'}, 'Eval': {'dataset': {'data_dir': '/content/drive/MyDrive/PaddleOCR/evaluate_data/Detection/data1/images', 'label_file_list': ['/content/drive/MyDrive/PaddleOCR/evaluate_data/Detection/data1/label.txt'], 'name': 'SimpleDataSet', 'transforms': [{'DecodeImage': {'channel_first': False, 'img_mode': 'BGR'}}, {'DetLabelEncode': None}, {'DetResizeForTest': None}, {'NormalizeImage': {'mean': [0.485, 0.456, 0.406], 'order': 'hwc', 'scale': '1./255.', 'std': [0.229, 0.224, 0.225]}}, {'ToCHWImage': None}, {'KeepKeys': {'keep_keys': ['image', 'shape', 'polys', 'ignore_tags']}}]}, 'loader': {'batch_size_per_card': 1, 'drop_last': False, 'num_workers': 2, 'shuffle': False}}, 'Global': {'amp_dtype': 'bfloat16', 'cal_metric_during_train': False, 'calc_metric_during_train': True, 'checkpoints': None, 'd2s_train_image_shape': [3, -1, -1], 'debug': False, 'distributed': False, 'epoch_num': 100, 'eval_batch_step': [0, 100], 'infer_img': 'doc/imgs_en/img_10.jpg', 'log_smooth_window': 20, 'pretrained_model': '/content/drive/MyDrive/PaddleOCR/pretrain_models/best_accuracy_det_ppocr_v3.pdparams', 'print_batch_step': 10, 'save_epoch_step': 100, 'save_inference_dir': None, 'save_model_dir': './output/ch_PP-OCR_v3_det_05102023_v2/', 'save_res_path': './checkpoints/det_db/predicts_db_ppocrv3_05102023_ppocrv3_v2.txt', 'use_gpu': True, 'use_visualdl': False}, 'Loss': {'loss_config_list': [{'DistillationDilaDBLoss': {'alpha': 5, 'balance_loss': True, 'beta': 10, 'key': 'maps', 'main_loss_type': 'DiceLoss', 'model_name_pairs': [['Student', 'Teacher'], ['Student2', 'Teacher']], 'ohem_ratio': 3, 'weight': 1.0}}, {'DistillationDMLLoss': {'key': 'maps', 'maps_name': 'thrink_maps', 'model_name_pairs': ['Student', 'Student2'], 'weight': 1.0}}, {'DistillationDBLoss': {'alpha': 5, 'balance_loss': True, 'beta': 10, 'main_loss_type': 'DiceLoss', 'model_name_list': ['Student', 'Student2'], 'ohem_ratio': 3, 'weight': 1.0}}], 'name': 'CombinedLoss'}, 'Metric': {'base_metric_name': 'DetMetric', 'key': 'Student', 'main_indicator': 'hmean', 'name': 'DistillationMetric'}, 'Optimizer': {'beta1': 0.9, 'beta2': 0.999, 'lr': {'learning_rate': 0.001, 'name': 'Cosine', 'warmup_epoch': 2}, 'name': 'Adam', 'regularizer': {'factor': 5e-05, 'name': 'L2'}}, 'PostProcess': {'box_thresh': 0.6, 'key': 'head_out', 'max_candidates': 1000, 'model_name': ['Student'], 'name': 'DistillationDBPostProcess', 'thresh': 0.3, 'unclip_ratio': 1.5}, 'Train': {'dataset': {'data_dir': '/content/drive/MyDrive/PaddleOCR/train_data/05102023-mor', 'label_file_list': ['/content/drive/MyDrive/PaddleOCR/train_data/05102023-mor/Label.txt'], 'name': 'SimpleDataSet', 'ratio_list': [1.0], 'transforms': [{'DecodeImage': {'channel_first': False, 'img_mode': 'BGR'}}, {'DetLabelEncode': None}, {'CopyPaste': None}, {'IaaAugment': {'augmenter_args': [{'args': {'p': 0.5}, 'type': 'Fliplr'}, {'args': {'rotate': [-10, 10]}, 'type': 'Affine'}, {'args': {'size': [0.5, 3]}, 'type': 'Resize'}]}}, {'EastRandomCropData': {'keep_ratio': True, 'max_tries': 50, 'size': [736, 1123]}}, {'MakeBorderMap': {'shrink_ratio': 0.4, 'thresh_max': 0.7, 'thresh_min': 0.3}}, {'MakeShrinkMap': {'min_text_size': 8, 'shrink_ratio': 0.4}}, {'NormalizeImage': {'mean': [0.485, 0.456, 0.406], 'order': 'hwc', 'scale': '1./255.', 'std': [0.229, 0.224, 0.225]}}, {'ToCHWImage': None}, {'KeepKeys': {'keep_keys': ['image', 'threshold_map', 'threshold_mask', 'shrink_map', 'shrink_mask']}}]}, 'loader': {'batch_size_per_card': 8, 'drop_last': False, 'num_workers': 4, 'shuffle': True}}, 'wandb': {'project': 'det_05102023_db_mobilenetv3', 'save_dir': './output/ch_PP-OCR_v3_det_05102023_v2/'}, 'profiler_options': None}
